---
 - name: testing windows
   hosts: 10.10.5.185
   tasks: 
    - name: Run SFTP login command
      win_shell: |
        Start-Process -NoNewWindow -FilePath "C:\path\to\psftp.exe" -ArgumentList "-l mysftp -pw 123456 sftp://10.10.5.76"
      register: sftp_result

    - name: Print SFTP output
      debug:
        var: sftp_result.stdout_lines

    # - name: Run login command
    #   win_command: 'cmdkey /add:10.10.5.76 /user:mysftp /pass:123456'
    #   register: cmdkey_result

    # - name: Check cmdkey result
    #   debug:
    #     var: cmdkey_result.stdout_lines

    # - name: Connect to the remote host
    #   win_command: 'mstsc /v:10.10.5.185'
    #   register: login_result

    # - name: Print login output
    #   debug:
    #     var: login_result.stdout_lines

    # - name: Run login command
    #   win_command: |
    #     cmdkey /add:10.10.5.76 /user:mysftp /pass:123456
    #     mstsc /v:10.10.5.185
    #   register: login_result

    # - name: Print login output
    #   debug:
    #     var: login_result.stdout_lines

    # - name: create dir for loading drivers
    #   win_file:
    #      path: C:\kapalya-drivers
    #      state: directory
    # - name: Transfer files via SFTP
    #   expect:
    #     command: sftp mysftp@10.10.5.76
    #     responses:
    #       # "(yes/no)?": "yes\n"
    #       "password: ": "123456\n"
    #     timeout: 30
    #     echo: yes
    #     spawn: yes
    #     commands:
    #       - "mget -r /sftp-upload/Ping/Replicadb C:\\kapalya-drivers"
    #       - "quit"
                 
## windows exporter installation

  #  - name: Download windows_exporter
  #    win_get_url:
  #     url: "https://github.com/prometheus-community/windows_exporter/releases/download/v0.23.1/windows_exporter-0.23.1-amd64.msi"
  #     dest: 'C:\Windows\windows_exporter_install.msi'

  #  - name: install Windows exporter
  #    win_package:
  #     path: 'C:\Windows\windows_exporter_install.msi'
  #     state: present
## windows exporter uninstallation:

   # - name: uninstall Windows exporter
   #   win_package:
   #    path: 'C:\Windows\windows_exporter_install.msi'
   #    state: absent
   # - name: Remove windows exporter .msi file 
   #   win_file:
   #     path: C:\Windows\windows_exporter_install.msi
   #     state: absent


